<Window x:Class="DeltaForceTracker.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:lvc="clr-namespace:LiveChartsCore.SkiaSharpView.WPF;assembly=LiveChartsCore.SkiaSharpView.WPF"
        xmlns:controls="clr-namespace:DeltaForceTracker.Controls"
        Title="{DynamicResource Lang.Title}"
        Height="820"
        Width="1080"
        Background="Transparent"
        WindowStartupLocation="CenterScreen"
        FontFamily="{StaticResource MainFont}">

    <WindowChrome.WindowChrome>
        <WindowChrome CaptionHeight="40" GlassFrameThickness="0" ResizeBorderThickness="4"/>
    </WindowChrome.WindowChrome>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/> <!-- Title Bar -->
            <RowDefinition Height="*"/>    <!-- Content -->
        </Grid.RowDefinitions>

        <!-- Animated Background Layer -->
        <controls:AnimatedBackground Grid.RowSpan="2"/>
        
        <!-- Custom Title Bar -->
        <Border Grid.Row="0" Background="{StaticResource MediumBackgroundBrush}" Padding="15,10">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- Title with Tactical Accent -->
                <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                    <Border Width="3" Height="20" Background="{StaticResource AccentBrush}" Margin="0,0,10,0" CornerRadius="1.5"/>
                    <TextBlock Text="DELTA FORCE" FontWeight="Bold" Foreground="{StaticResource AccentBrush}" FontSize="16" Margin="0,0,5,0"/>
                    <TextBlock Text="TRACKER" FontWeight="Light" Foreground="{StaticResource TextPrimaryBrush}" FontSize="16"/>
                </StackPanel>

                <!-- Language Switcher & Window Controls -->
                <StackPanel Grid.Column="2" Orientation="Horizontal" WindowChrome.IsHitTestVisibleInChrome="True">
                    <!-- Language Toggle Button -->
                    <Button x:Name="LanguageToggleButton" 
                            Content="EN"
                            Width="50" 
                            Height="30"
                            Margin="0,0,15,0"
                            Style="{StaticResource ModernButton}"
                            FontSize="11"
                            Click="LanguageToggleButton_Click"/>
                    
                    <!-- Window Control Buttons -->
                    <Button x:Name="MinimizeButton"
                            Content="—"
                            Style="{StaticResource ModernButton}"
                            Width="40"
                            Height="30"
                            FontSize="16"
                            Margin="5,0,0,0"
                            Click="MinimizeButton_Click"
                            ToolTip="Minimize"/>
                    
                    <Button x:Name="MaximizeButton"
                            Content="□"
                            Style="{StaticResource ModernButton}"
                            Width="40"
                            Height="30"
                            FontSize="16"
                            Margin="5,0,0,0"
                            Click="MaximizeButton_Click"
                            ToolTip="Maximize"/>
                    
                    <Button x:Name="CloseButton"
                            Content="✕"
                            Style="{StaticResource ModernButton}"
                            Width="40"
                            Height="30"
                            FontSize="16"
                            Margin="5,0,0,0"
                            Click="CloseButton_Click"
                            ToolTip="Close"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Main Content -->
        <TabControl Grid.Row="1" Margin="20">
            <TabItem Header="{DynamicResource Lang.Dashboard}">
                <ScrollViewer VerticalScrollBarVisibility="Auto" PanningMode="VerticalOnly">
                    <StackPanel Margin="0,10,0,0">
                        <!-- Top Stats Row -->
                        <Grid Margin="0,0,0,20">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="2*"/>
                                <ColumnDefinition Width="1.5*"/>
                            </Grid.ColumnDefinitions>

                            <!-- Current Balance (Big Card) -->
                            <Border x:Name="BalanceCard" Style="{StaticResource Card}" Grid.Column="0" Margin="0,0,10,0">
                                <StackPanel>
                                    <TextBlock Text="{DynamicResource Lang.CurrentBalance}" Style="{StaticResource LabelText}"/>
                                    <TextBlock x:Name="CurrentBalanceText" Text="0.00M" Style="{StaticResource ValueText}" Foreground="{StaticResource AccentBrush}"/>
                                    <TextBlock x:Name="LastScanText" Text="{DynamicResource Lang.Status.NoScans}" Style="{StaticResource LabelText}" Margin="0,5,0,0" Opacity="0.7"/>
                                </StackPanel>
                            </Border>

                            <!-- Daily P&L -->
                            <Border x:Name="PLCard" Style="{StaticResource Card}" Grid.Column="1" Margin="10,0,0,0">
                                <StackPanel VerticalAlignment="Center">
                                    <TextBlock Text="{DynamicResource Lang.DailyPL}" Style="{StaticResource LabelText}"/>
                                    <TextBlock x:Name="DailyPLText" Text="+0.00M" FontSize="42" FontWeight="Bold" Foreground="{StaticResource SuccessBrush}"/>
                                    
                                    <!-- Today Counters -->
                                    <TextBlock x:Name="TodayCountersText"
                                               Text="Cheaters 0 | Tilts 0 | Reds 0"
                                               FontFamily="{StaticResource MainFont}"
                                               FontSize="11"
                                               Foreground="{StaticResource TextSecondaryBrush}"
                                               Margin="0,10,0,0"
                                               TextWrapping="Wrap"
                                               HorizontalAlignment="Center"/>
                                </StackPanel>
                            </Border>
                        </Grid>

                        <!-- Actions Row (Full Width) -->
                        <Border x:Name="ActionsCard" Style="{StaticResource Card}" Margin="0,10,0,10" Padding="20">
                            <StackPanel>
                                <!-- Header with integrated status -->
                                <TextBlock Margin="0,0,0,20"
                                          FontFamily="{StaticResource MainFont}"
                                          FontSize="14"
                                          FontWeight="SemiBold"
                                          Foreground="{StaticResource TextSecondaryBrush}">
                                    <Run Text="{DynamicResource Lang.Actions}"/>
                                    <Run Text=" • "/>
                                    <Run x:Name="StatusTextInline" 
                                         Text="{DynamicResource Lang.Status.Ready}"
                                         Foreground="{StaticResource AccentBrush}"/>
                                </TextBlock>
                                
                                <!-- Action Buttons (Horizontal Layout) -->
                                <Grid Margin="0,0,0,20">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="10"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="10"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    
                                    <Button x:Name="ScanButton" 
                                            Grid.Column="0"
                                            Content="{DynamicResource Lang.ScanNow}" 
                                            Style="{StaticResource ModernButton}" 
                                            Click="ScanButton_Click"
                                            Height="45"/>
                                    
                                    <Button x:Name="SelectRegionButton" 
                                            Grid.Column="2"
                                            Content="{DynamicResource Lang.SelectRegion}" 
                                            Style="{StaticResource ModernButton}" 
                                            Click="SelectRegionButton_Click"
                                            Height="45"/>
                                    
                                    <Button x:Name="ResetDataButton" 
                                            Grid.Column="4"
                                            Content="{DynamicResource Lang.ResetAnalytics}" 
                                            Style="{StaticResource DangerButton}" 
                                            Click="ResetDataButton_Click"
                                            Height="45"/>
                                </Grid>
                                
                                <Separator Margin="0,0,0,15" Background="{StaticResource BorderBrush}"/>
                                
                                <!-- Bottom Row: Hotkey and Floating Button -->
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    
                                    <!-- Hotkey Info (Left) -->
                                    <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                                        <TextBlock Text="{DynamicResource Lang.Hotkey}" 
                                                  Style="{StaticResource LabelText}" 
                                                  FontSize="11"
                                                  VerticalAlignment="Center"
                                                  Margin="0,0,10,0"/>
                                        <TextBlock Text="F8" 
                                                  FontFamily="{StaticResource MainFont}"
                                                  FontSize="16"
                                                  FontWeight="Bold"
                                                  Foreground="{StaticResource AccentBrush}"
                                                  VerticalAlignment="Center"/>
                                    </StackPanel>
                                    
                                    <!-- Floating Button Toggle (Right) -->
                                    <StackPanel Grid.Column="1" 
                                                HorizontalAlignment="Right"
                                                VerticalAlignment="Center">
                                        <CheckBox x:Name="FloatingButtonToggle"
                                                  Content="{DynamicResource Lang.FloatingButton}"
                                                  FontFamily="{StaticResource MainFont}"
                                                  FontSize="12"
                                                  Foreground="{StaticResource TextSecondaryBrush}"
                                                  Cursor="Hand"
                                                  Checked="FloatingButtonToggle_Checked"
                                                  Unchecked="FloatingButtonToggle_Unchecked"/>
                                        
                                        <!-- Opacity Slider -->
                                        <StackPanel Orientation="Horizontal" 
                                                    Margin="0,8,0,0"
                                                    HorizontalAlignment="Right">
                                            <TextBlock Text="{DynamicResource Lang.FloatingButtonOpacity}"
                                                       FontFamily="{StaticResource MainFont}"
                                                       FontSize="10"
                                                       Foreground="{StaticResource TextSecondaryBrush}"
                                                       VerticalAlignment="Center"
                                                       Margin="0,0,8,0"/>
                                            <Slider x:Name="FloatingButtonOpacitySlider"
                                                    Width="100"
                                                    Minimum="0.05"
                                                    Maximum="1.0"
                                                    Value="0.15"
                                                    TickFrequency="0.05"
                                                    IsSnapToTickEnabled="True"
                                                    VerticalAlignment="Center"
                                                    ValueChanged="FloatingButtonOpacitySlider_ValueChanged"/>
                                            <TextBlock x:Name="OpacityValueLabel"
                                                       Text="15%"
                                                       FontFamily="{StaticResource MainFont}"
                                                       FontSize="10"
                                                       Foreground="{StaticResource AccentBrush}"
                                                       VerticalAlignment="Center"
                                                       Margin="8,0,0,0"
                                                       MinWidth="35"/>
                                        </StackPanel>
                                    </StackPanel>
                                </Grid>
                            </StackPanel>
                        </Border>

                        <!-- Quote of the Day Card -->
                        <Border x:Name="QuoteCard" Style="{StaticResource Card}">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>

                                <!-- Header with Refresh Button -->
                                <Grid Grid.Row="0" Margin="0,0,0,15">
                                    <TextBlock Text="{DynamicResource Lang.QuoteOfTheDay}" 
                                             Style="{StaticResource LabelText}"
                                             VerticalAlignment="Center"/>
                                    <Button x:Name="RefreshQuoteButton"
                                          Content="↻"
                                          Style="{StaticResource ModernButton}"
                                          FontSize="20"
                                          Padding="8,4"
                                          HorizontalAlignment="Right"
                                          Click="RefreshQuoteButton_Click"
                                          ToolTip="{DynamicResource Lang.RefreshQuote}"/>
                                </Grid>

                                <!-- Quote Text -->
                                <TextBlock x:Name="QuoteText"
                                         Grid.Row="1"
                                         Text="Сегодня — хороший день чтобы win!"
                                         FontSize="18"
                                         FontWeight="Medium"
                                         FontStyle="Italic"
                                         Foreground="{StaticResource AccentBrush}"
                                         TextWrapping="Wrap"
                                         LineHeight="26"
                                         HorizontalAlignment="Center"
                                         TextAlignment="Center"/>
                            </Grid>
                        </Border>

                        <!-- Event Counters Row - Bottom Center -->
                        <Grid HorizontalAlignment="Center" Margin="0,30,0,0" MaxWidth="800">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="15"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="15"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            
                            <!-- Tilt Counter (Left) -->
                            <StackPanel Grid.Column="0">
                                <Button x:Name="TiltButton"
                                        Content="{DynamicResource Lang.TiltButton}"
                                        Style="{StaticResource ModernButton}"
                                        Height="60"
                                        MinWidth="200"
                                        Click="TiltButton_Click"/>
                                <TextBlock x:Name="UndoTiltButton"
                                           Text="{DynamicResource Lang.Undo}"
                                           FontFamily="{StaticResource MainFont}"
                                           FontSize="10"
                                           Foreground="{StaticResource TextSecondaryBrush}"
                                           HorizontalAlignment="Center"
                                           Margin="0,5,0,0"
                                           Cursor="Hand"
                                           MouseLeftButtonUp="UndoTiltButton_Click"/>
                            </StackPanel>
                            
                            <!-- Red Items Counter (Center, Red Style) -->
                            <StackPanel Grid.Column="2">
                                <Button x:Name="RedButton"
                                        Content="{DynamicResource Lang.Red}"
                                        Style="{StaticResource TiltButton}"
                                        Height="60"
                                        MinWidth="200"
                                        Click="RedButton_Click"/>
                                <TextBlock x:Name="UndoRedButton"
                                           Text="{DynamicResource Lang.Undo}"
                                           FontFamily="{StaticResource MainFont}"
                                           FontSize="10"
                                           Foreground="{StaticResource TextSecondaryBrush}"
                                           HorizontalAlignment="Center"
                                           Margin="0,5,0,0"
                                           Cursor="Hand"
                                           MouseLeftButtonUp="UndoRedButton_Click"/>
                            </StackPanel>
                            
                            <!-- Cheater Counter (Right) -->
                            <StackPanel Grid.Column="4">
                                <Button x:Name="CheaterButton"
                                        Content="{DynamicResource Lang.Cheater}"
                                        Style="{StaticResource ModernButton}"
                                        Height="60"
                                        MinWidth="200"
                                        Click="CheaterButton_Click"/>
                                <TextBlock x:Name="UndoCheaterButton"
                                           Text="{DynamicResource Lang.Undo}"
                                           FontFamily="{StaticResource MainFont}"
                                           FontSize="10"
                                           Foreground="{StaticResource TextSecondaryBrush}"
                                           HorizontalAlignment="Center"
                                           Margin="0,5,0,0"
                                           Cursor="Hand"
                                           MouseLeftButtonUp="UndoCheaterButton_Click"/>
                            </StackPanel>
                        </Grid>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <TabItem Header="{DynamicResource Lang.Analytics}">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="0,10,0,0">
                        <!-- Chart -->
                        <Border Style="{StaticResource Card}" Height="350">
                            <StackPanel>
                                <!-- Header with Toggle -->
                                <Grid Margin="0,0,0,10">
                                    <TextBlock Text="{DynamicResource Lang.BalanceHistory}" 
                                               Style="{StaticResource LabelText}"
                                               VerticalAlignment="Center"/>
                                    <TextBlock x:Name="ChartToggleButton"
                                               HorizontalAlignment="Right"
                                               VerticalAlignment="Center"
                                               FontFamily="{StaticResource MainFont}"
                                               FontSize="11"
                                               FontWeight="Bold"
                                               Foreground="{StaticResource AccentBrush}"
                                               Cursor="Hand"
                                               MouseLeftButtonUp="ChartToggleButton_Click">
                                        <Run Text="◀"/><Run Text=" "/><Run x:Name="ChartToggleText" Text="{DynamicResource Lang.Analytics.ShowRecent}"/>
                                    </TextBlock>
                                </Grid>
                                <lvc:CartesianChart x:Name="BalanceChart" Height="280" Margin="0,0,0,0"/>
                            </StackPanel>
                        </Border>

                        <!-- Stats Grid -->
                        <Grid Margin="0,0,0,20">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/> <!-- NEW: For Tilt Counter -->
                            </Grid.ColumnDefinitions>

                            <Border Style="{StaticResource Card}" Grid.Column="0" Margin="0,0,10,0" Padding="15">
                                <StackPanel>
                                    <TextBlock Text="{DynamicResource Lang.BestDay}" Style="{StaticResource LabelText}" FontSize="11"/>
                                    <TextBlock x:Name="BestDayText" Text="+0.00M" Foreground="{StaticResource SuccessBrush}" FontSize="20" FontWeight="Bold"/>
                                </StackPanel>
                            </Border>

                            <Border Style="{StaticResource Card}" Grid.Column="1" Margin="5,0,5,0" Padding="15">
                                <StackPanel>
                                    <TextBlock Text="{DynamicResource Lang.WorstDay}" Style="{StaticResource LabelText}" FontSize="11"/>
                                    <TextBlock x:Name="WorstDayText" Text="-0.00M" Foreground="{StaticResource ErrorBrush}" FontSize="20" FontWeight="Bold"/>
                                </StackPanel>
                            </Border>

                            <Border Style="{StaticResource Card}" Grid.Column="2" Margin="5,0,5,0" Padding="15">
                                <StackPanel>
                                    <TextBlock Text="{DynamicResource Lang.HighestBalance}" Style="{StaticResource LabelText}" FontSize="11"/>
                                    <TextBlock x:Name="HighestBalanceText" Text="0.00M" Foreground="{StaticResource TextPrimaryBrush}" FontSize="20" FontWeight="Bold"/>
                                </StackPanel>
                            </Border>

                            <Border Style="{StaticResource Card}" Grid.Column="3" Margin="10,0,0,0" Padding="15">
                                <StackPanel>
                                    <TextBlock Text="{DynamicResource Lang.TotalScans}" Style="{StaticResource LabelText}" FontSize="11"/>
                                    <TextBlock x:Name="TotalScansText" Text="0" Foreground="{StaticResource TextPrimaryBrush}" FontSize="20" FontWeight="Bold"/>
                                </StackPanel>
                            </Border>

                            <!-- Tilt Counter Card -->
                            <Border Style="{StaticResource Card}" Grid.Column="4" Margin="10,0,0,0" Padding="15">
                                <StackPanel>
                                    <TextBlock Text="{DynamicResource Lang.Analytics.Tilts}" 
                                               Style="{StaticResource LabelText}" 
                                               FontSize="11"/>
                                    <TextBlock x:Name="TotalTiltsText" 
                                               Text="0" 
                                               Foreground="#FF1744" 
                                               FontSize="28" 
                                               FontWeight="Bold"/>
                                    <TextBlock Text="{DynamicResource Lang.Analytics.TodayTilts}" 
                                               Style="{StaticResource LabelText}" 
                                               FontSize="10" 
                                               Margin="0,5,0,2"/>
                                    <TextBlock x:Name="TodayTiltsText" 
                                               Text="0" 
                                               Foreground="#DC143C" 
                                               FontSize="16" 
                                               FontWeight="Bold"/>
                                </StackPanel>
                            </Border>
                        </Grid>

                        <!-- Event Counters Row -->
                        <Grid Margin="0,20,0,20">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <!-- Total Tilts Card -->
                            <Border Style="{StaticResource Card}" Grid.Column="0" Margin="0,0,10,0" Padding="20">
                                <StackPanel HorizontalAlignment="Center">
                                    <TextBlock Text="{DynamicResource Lang.TotalTilts}" 
                                               Style="{StaticResource LabelText}"
                                               FontSize="11"
                                               HorizontalAlignment="Center"/>
                                    <TextBlock x:Name="TotalTiltsCard" 
                                               Text="0" 
                                               FontSize="32" 
                                               FontWeight="Bold" 
                                               Foreground="#FF1744"
                                               HorizontalAlignment="Center"/>
                                </StackPanel>
                            </Border>

                            <!-- Total Cheaters Card -->
                            <Border Style="{StaticResource Card}" Grid.Column="1" Margin="10,0,10,0" Padding="20">
                                <StackPanel HorizontalAlignment="Center">
                                    <TextBlock Text="{DynamicResource Lang.TotalCheaters}" 
                                               Style="{StaticResource LabelText}"
                                               FontSize="11"
                                               HorizontalAlignment="Center"/>
                                    <TextBlock x:Name="TotalCheatersText" 
                                               Text="0" 
                                               FontSize="32" 
                                               FontWeight="Bold" 
                                               Foreground="{StaticResource ErrorBrush}"
                                               HorizontalAlignment="Center"/>
                                </StackPanel>
                            </Border>

                            <!-- Total Reds Card -->
                            <Border Style="{StaticResource Card}" Grid.Column="2" Margin="10,0,0,0" Padding="20">
                                <StackPanel HorizontalAlignment="Center">
                                    <TextBlock Text="{DynamicResource Lang.TotalReds}" 
                                               Style="{StaticResource LabelText}"
                                               FontSize="11"
                                               HorizontalAlignment="Center"/>
                                    <TextBlock x:Name="TotalRedsText" 
                                               Text="0" 
                                               FontSize="32" 
                                               FontWeight="Bold" 
                                               Foreground="{StaticResource AccentBrush}"
                                               HorizontalAlignment="Center"/>
                                </StackPanel>
                            </Border>
                        </Grid>

                        <!-- History Table -->
                        <Border Style="{StaticResource Card}">
                            <StackPanel>
                                <TextBlock Text="{DynamicResource Lang.ScanHistory}" Style="{StaticResource LabelText}"/>
                                <DataGrid x:Name="HistoryDataGrid" MaxHeight="400" Margin="0,10,0,0">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="{DynamicResource Lang.Time}" Binding="{Binding Timestamp, StringFormat='yyyy-MM-dd HH:mm:ss'}" Width="*"/>
                                        <DataGridTextColumn Header="{DynamicResource Lang.RawValue}" Binding="{Binding RawValue}" Width="*"/>
                                        
                                        <!-- Delta Column -->
                                        <DataGridTemplateColumn Header="{DynamicResource Lang.Delta}" Width="*">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                                        <TextBlock Text="{Binding DeltaIndicator}" 
                                                                   Foreground="{Binding DeltaColor}"
                                                                   FontSize="12"
                                                                   FontWeight="Bold"
                                                                   Margin="0,0,5,0"/>
                                                        <TextBlock Text="{Binding DeltaText}" 
                                                                   Foreground="{Binding DeltaColor}"
                                                                   FontWeight="Bold"
                                                                   FontFamily="{StaticResource MonoFont}"/>
                                                    </StackPanel>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                        </DataGridTemplateColumn>
                                        
                                        <DataGridTextColumn Header="{DynamicResource Lang.NumericValue}" Binding="{Binding NumericValue, StringFormat='N2'}" Width="*"/>
                                        
                                        <!-- Delete Button Column -->
                                        <DataGridTemplateColumn Header="{DynamicResource Lang.Delete}" Width="Auto">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <Button Content="✕"
                                                            Tag="{Binding Id}"
                                                            Click="DeleteScanButton_Click"
                                                            Style="{StaticResource DangerButton}"
                                                            Width="32"
                                                            Height="24"
                                                            FontSize="14"
                                                            Padding="0"
                                                            ToolTip="{DynamicResource Lang.Delete}"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                        </DataGridTemplateColumn>
                                    </DataGrid.Columns>
                                </DataGrid>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- Achievements Tab -->
            <TabItem x:Name="AchievementsTab" SelectionChanged="AchievementsTab_SelectionChanged">
                <TabItem.Header>
                    <Grid>
                        <TextBlock Text="{DynamicResource Lang.Achievements}" />
                        <Border x:Name="AchievementsBadge"
                                Background="#FF2A6D"
                                CornerRadius="8"
                                Padding="5,2"
                                Margin="-10,-8,0,0"
                                HorizontalAlignment="Right"
                                VerticalAlignment="Top"
                                Visibility="Collapsed">
                            <TextBlock x:Name="AchievementsBadgeCount"
                                       Text="0"
                                       FontSize="9"
                                       FontWeight="Bold"
                                       Foreground="White"/>
                        </Border>
                    </Grid>
                </TabItem.Header>
                <ScrollViewer VerticalScrollBarVisibility="Auto" PanningMode="VerticalOnly">
                    <StackPanel Margin="20">
                        <!-- Progress Header -->
                        <Border Background="{StaticResource CardBrush}" 
                                Padding="20" 
                                CornerRadius="8" 
                                Margin="0,0,0,20"
                                Effect="{StaticResource CardShadow}">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                
                                <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Grid.Column="0">
                                    <TextBlock Text="{DynamicResource Lang.Achievements}" 
                                              FontSize="24" 
                                              FontWeight="Bold" 
                                              Foreground="{StaticResource AccentBrush}"
                                              VerticalAlignment="Center"/>
                                              
                                    <!-- Reset Debug Button -->
                                    <Button x:Name="ResetAchievementsButton"
                                            Content="{DynamicResource Lang.Reset}"
                                            Width="60" Height="24"
                                            Style="{StaticResource ModernButton}"
                                            Background="#334155"
                                            FontSize="10"
                                            Margin="15,0,0,0"
                                            Click="ResetAchievementsButton_Click"
                                            Cursor="Hand"
                                            VerticalAlignment="Center"/>
                                </StackPanel>

                                <TextBlock x:Name="AchievementProgressText"
                                          Text="0 / 20"
                                          FontSize="18"
                                          FontWeight="SemiBold"
                                          Foreground="{StaticResource TextSecondaryBrush}"
                                          HorizontalAlignment="Right"
                                          VerticalAlignment="Center"
                                          Grid.Column="1"/>
                            </Grid>
                        </Border>

                        <!-- Achievements Grid (Flow layout) -->
                        <ItemsControl x:Name="AchievementsGrid">
                            <ItemsControl.ItemsPanel>
                                <ItemsPanelTemplate>
                                    <WrapPanel Orientation="Horizontal" HorizontalAlignment="Center"/>
                                </ItemsPanelTemplate>
                            </ItemsControl.ItemsPanel>
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Border Background="{StaticResource CardBrush}"
                                            Margin="5"
                                            Padding="10"
                                            CornerRadius="8"
                                            Effect="{StaticResource CardShadow}"
                                            Cursor="Hand"
                                            Opacity="{Binding Opacity}"
                                            MouseLeftButtonUp="Achievement_Click"
                                            ToolTip="{Binding DisplayDescription}">
                                        <StackPanel HorizontalAlignment="Center" Width="100">
                                            <!-- Achievement Icon -->
                                            <Image Source="{Binding IconPath}"
                                                   Width="64" 
                                                   Height="64"
                                                   Margin="0,0,0,8"
                                                   RenderOptions.BitmapScalingMode="Fant"/>
                                            
                                            <!-- Achievement Title -->
                                            <TextBlock Text="{Binding DisplayTitle}"
                                                      FontSize="11"
                                                      FontWeight="SemiBold"
                                                      Foreground="{StaticResource TextPrimaryBrush}"
                                                      TextAlignment="Center"
                                                      TextWrapping="Wrap"
                                                      Margin="0,0,0,4"/>
                                            
                                            <!-- Valid Description Binding -->
                                            <TextBlock Text="{Binding DisplayDescription}"
                                                      FontSize="9"
                                                      Foreground="{StaticResource TextSecondaryBrush}"
                                                      TextAlignment="Center"
                                                      TextWrapping="Wrap"
                                                      Opacity="0.8"/>
                                        </StackPanel>
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>
            
            <!-- Easter Egg: Heart of Africa (Hidden) -->
        </TabControl>

        <!-- Toast Container (top-right overlay) -->
        <Grid x:Name="ToastContainer"
              Grid.Row="1"
              HorizontalAlignment="Right"
              VerticalAlignment="Top"
              Margin="20,20,20,0"
              IsHitTestVisible="False"/>

        <!-- Made with HOA - Bottom Right Footer -->
        <StackPanel Grid.Row="1"
                    Orientation="Vertical"
                    HorizontalAlignment="Right"
                    VerticalAlignment="Bottom"
                    Margin="0,0,15,8">
            <TextBlock FontSize="10"
                       Foreground="{StaticResource TextSecondaryBrush}"
                       Opacity="0.6"
                       TextAlignment="Right">
                <Run Text="Made with "/>
                <InlineUIContainer BaselineAlignment="Center">
                    <Image x:Name="HOAInlineSprite"
                           Source="Resources/achievements/hoa.png"
                           Width="14"
                           Height="14"
                           Cursor="Hand"
                           MouseLeftButtonUp="EasterEggHOA_Click"
                           ToolTip="❤️"
                           VerticalAlignment="Center"/>
                </InlineUIContainer>
                <Run Text=" to Delta Force game | v2.2.1"/>
            </TextBlock>
            <TextBlock FontSize="9"
                       Opacity="0.5"
                       TextAlignment="Right"
                       Margin="0,2,0,0">
                <Hyperlink x:Name="ReleasesLink"
                           NavigateUri="https://github.com/tmmwld/deltatracker/releases"
                           RequestNavigate="Hyperlink_RequestNavigate"
                           Foreground="{StaticResource TextSecondaryBrush}"/>
            </TextBlock>
        </StackPanel>
    </Grid>
</Window>

